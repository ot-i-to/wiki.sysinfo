<!--
title: SSH-туннель
description: Магия :)
published: true
date: 2022-11-09T14:06:28.867Z
tags: lunux, ssh, tunnel, port, forward
editor: ckeditor
dateCreated: 2022-11-09T13:23:54.202Z
-->

<h3>Несколько практических примера применения SSH-туннеля.</h3>
<p>Перенаправление порта SSH-клиента (на компьютере с которого работаете), на порт SSH-сервера (удаленного компьютера) и далее на порт, расположенный на конечном компьютере или любом другом устройстве.</p>
<p><code>ssh -L [LOCAL_IP:]LOCAL_PORT:DESTINATION:DESTINATION_PORT [USER@]SSH_SERVER -p [PORT_NUMBER]</code></p>
<p>где:</p>
<p><code>[LOCAL_IP:]LOCAL_PORT</code> – IP-адрес и номер порта локального компьютера. Если локальный IP не указан, SSH-клиент привязывается к локальному хосту (localhost 127.0.0.1). В качестве LOCAL_PORT вы можете использовать любой номер порта больше, чем 1024. Значения меньше 1024 являются привилегированными портами и могут использоваться только пользователем root.</p>
<p><code>DESTINATION:DESTINATION_PORT</code> – IP/имя хоста и порт машины назначения расположеным на конечном компьюторе до готорого желаете получить доступ.</p>
<p><code>[USER@]SERVER_IP</code> – Удаленный пользователь и IP-адрес сервера который вы собираетесь использовать как посредником.&nbsp;</p>
<p><code>-p [PORT_NUMBER]</code> – Используйте эту опцию если SSH-сервер прослушивает не 22-й порт по умолчанию.</p>
<p>&nbsp;</p>
<hr>
<p>Но выше приведенный пример будет работать пока команда активна, что не очень удобно. Чтобы после выполнения команда осталась в фоновом режиме, она должна выглядеть так:</p>
<p><code>ssh -L [LOCAL_IP:]LOCAL_PORT:DESTINATION:DESTINATION_PORT [USER@]SSH_SERVER -p [PORT_NUMBER] &amp;</code></p>
<p>… &nbsp;и опять не очень корректно, т.к. команда хоть и перейдёт в фоновый режим, но продолжит сыпать свои сообщения в консоль из которой ее запустили, &nbsp;Для полноценного фонового режима у ssh предусмотрены опции:</p>
<p><code>ssh -f -N -L [LOCAL_IP:]LOCAL_PORT:DESTINATION:DESTINATION_PORT [USER@]SSH_SERVER -p [PORT_NUMBER]</code></p>
<p>где опции:</p>
<p><code>-f</code> – Переход ssh в фоновый режим непосредственно перед выполнением команды.</p>
<p><code>-N</code> – Не выполнять удаленную команду. Это полезно только для перенаправления портов.</p>
<blockquote>
  <p>Поздравляю … теперь ваш туннель будет активен на локальном компьютере до тех пор пока не остановите соответствующий ssh процесс, отвечающий за него, командой <code>kill -9 [PID]</code> .</p>
</blockquote>
<hr>
<p>На этих ссылках можно почитать и про другие возможности:</p>
<ul>
  <li><a href="https://www.cloud4y.ru/blog/ssh-tunnels/"><i>SSH-туннели: практические примеры и ключевые функции</i></a></li>
  <li><a href="https://selectel.ru/blog/ssh-tunnels/"><i>Команды и практическое применения функций SSH-туннелей</i></a></li>
  <li><a href="https://habr.com/ru/post/331348/"><i>Магия SSH</i></a></li>
</ul>
<p>&nbsp;</p>

<!--
title: SIP-Ping v.1
description: Pythone скрипт 
published: true
date: 2022-12-15T11:35:38.325Z
tags: voip, sip, ping, options, monitoring, pythone
editor: ckeditor
dateCreated: 2022-12-15T11:35:38.325Z
-->

<h4>Утилита диагностики VoIP использующая протокол SIP сообщения OPTIONS в качестве ping для анализа состояния носта.</h4>
<blockquote>
  <p>Для работы утилиты SIP Ping требуется работающая среда Python 2.x., но возможно заработает и на Python 3.x (не провералось).<br>Хост, который вы пингуете, должен отвечать на пакеты OPTIONS. Неважно, что он отвечает - 200, 403, даже 501 все в порядке, если что-то возвращается с неповрежденным Call-ID. Если вы пингуете устройство, которое фильтрует SIP-трафик по доменному имени (например, принимает только пакеты вида From: user@**company.com**), вам может потребоваться использовать опцию “-d” для установки правильного доменного имени.<br><br>SIP Ping работает только по UDP и не может работать с TCP или TLS.<br>&nbsp;</p>
</blockquote>
<p>Утилита является модернизаций утилиты&nbsp;<a href="https://github.com/cathoderaydude/sip-ping"> cathoderaydude/sip-ping</a> , но внесены следующие изменения:&nbsp;</p>
<ul>
  <li>исправлено неработающая опция “-с”&nbsp;</li>
  <li>добавлены опции позволяющие выполнять произвольный скрипт в системе при достижения порога неудачных пингов:</li>
</ul>
<p><code>&nbsp;--crun count &nbsp;&nbsp;</code> &nbsp; &nbsp; Count lost the run shell script (default 0 - off)</p>
<p><code>&nbsp;--cnew count &nbsp;&nbsp;</code> &nbsp; &nbsp;Number of successful attempts to reset the failure &nbsp;counter(default 10, 0 - off)</p>
<p><code>&nbsp;--run script &nbsp;&nbsp;</code> &nbsp; &nbsp;Path/Name lost shell script (./script.sh))</p>
<p><code>&nbsp;--pause timeout&nbsp;</code> Pause after script execution (.default 60 sec.))</p>
<h5><br>Пример запуска:<br><code>/usr/share/sipping/sipping.py -p 5060 -i 10.15.1.154:5099 10.15.1.154 -I 60000 -t 10000 -w '/var/log/asterisk/sipping.log' --pause 300 --crun 10 --run '/usr/share/sipping/script.run' -q</code></h5>
<p>Скачать данную версиб утилиту можно тут.</p>
<p>&nbsp;</p>

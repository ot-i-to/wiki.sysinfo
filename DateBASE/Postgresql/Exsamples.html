<!--
title: INSERT если не прошел UPDATE
description: Postgresq - выполняем INSERT если не прошел UPDATE
published: true
date: 2022-04-20T15:38:26.921Z
tags: if, postgresql, insert, update, error
editor: ckeditor
dateCreated: 2022-04-20T15:22:49.341Z
-->

<h3>Если не прошел UPDATE то делаем INSERT</h3>
<p>Создаем функцию:</p>
<pre><code class="language-plaintext">create function UPDATE_OR_INSERT (query_update text,query_insert text) returns void as 
$$ 
declare 
begin
	execute query_update;
	if FOUND=false then 
	execute(query_insert);
	end if;
end
$$ language plpgsql;</code></pre>
<p>Пример:</p>
<p>SELECT UPDATE_OR_INSERT('UPDATE table SET val = '||x||' WHERE id = ‘||y||’::text', 'INSERT INTO table (id, val) VALUES ('||y||', '||x||')'::text)</p>
<p>… не проверял, но должно работать :)</p>
<p>&nbsp;</p>

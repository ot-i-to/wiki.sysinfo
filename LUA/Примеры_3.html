<!--
title: Пример 3 ... Поиск по файлу
description: Разныее примеры
published: true
date: 2023-11-05T15:06:58.566Z
tags: lua, samples, file, find
editor: ckeditor
dateCreated: 2021-11-11T23:46:44.422Z
-->

<h6>Функция, которая анализирует /proc/meminfo и возвращает его в виде таблицы:</h6>
<pre><code class="language-plaintext">function get_meminfo(fn)
   local r={}
   local f=assert(io.open(fn,"r"))
   -- read the whole file into s
   local s=f:read("*a")
   -- now enumerate all occurances of "SomeName: SomeValue"
   -- and assign the text of SomeName and SomeValue to k and v
   for k,v in string.gmatch(s,"(%w+): *(%d+)") do
           -- Save into table:
       r[k]=v
   end
   f:close()
   return r
end
-- use it
m=get_meminfo("/proc/meminfo")
print(m.MemTotal, m.MemFree)</code></pre>
<h6>Можно использовать io.lines :</h6>
<pre><code class="language-plaintext">for line in io.lines("/proc/meminfo") do
   if line:find("MemTotal") then --// Syntactic sugar for string.find(line, "MemTotal")
       --// If logic here...
   elseif --// I don't quite understand this part in your code.
   end
end</code></pre>
<p><strong>Пример с CSV файлом (</strong>https://opendata.digital.gov.ru/registry/numeric/downloads)<strong>:</strong></p>
<pre><code class="language-plaintext">function string:split( inSplitPattern, outResults )
 if not outResults then
    outResults = { }
 end
 local theStart = 1
 local theSplitStart, theSplitEnd = string.find( self, inSplitPattern, theStart )
 while theSplitStart do
    table.insert( outResults, string.sub( self, theStart, theSplitStart-1 ) )
    theStart = theSplitEnd + 1
    theSplitStart, theSplitEnd = string.find( self, inSplitPattern, theStart )
 end
 table.insert( outResults, string.sub( self, theStart ) )
 return outResults
end
n = 1
local f = io.open("/tmp/dev/DEF-9xx.csv")
for line in f:lines() do
 print("--&gt; "..n.." &lt;--")
 TBL = line:split(";");
 for i = 1, #TBL do
   print(i .. ") " .. TBL[i])
 end
 n = n + 1
end</code></pre>
<p>&nbsp;</p>
